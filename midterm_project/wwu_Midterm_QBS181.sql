drop table [wwu].[mt]
select * from [wwu].[DIQ]
--create a copy
select * into [wwu].[mt] from [wwu].[DIQ];

alter table [wwu].[mt]
alter column [_DID040_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ160_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ170_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ172_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ175A_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ175B_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ175C_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ175D_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ175E_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ175F_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ175G_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ175H_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ175I_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ175J_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ175K_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ175L_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ175M_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ175N_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ175O_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ175P_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ175Q_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ175R_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ175S_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ175T_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ175U_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ175V_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ175W_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ175X_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ180_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ050_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DID060_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ060U_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ070_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ230_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ240_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DID250_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DID260_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ260U_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ275_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ280_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ291_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ300S_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ300D_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DID310S_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DID310D_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DID320_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DID330_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DID341_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DID350_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ350U_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ360_] NVARCHAR(50) NULL;
alter table [wwu].[mt]
alter column [_DIQ080_] NVARCHAR(50) NULL;

update [wwu].[mt]set [_DID040_] = NULL
where [_DID040_] = 'NA'
update [wwu].[mt]set [_DIQ160_] = NULL
where [_DIQ160_] = 'NA'
update [wwu].[mt]set [_DIQ170_] = NULL
where [_DIQ170_] = 'NA'
update [wwu].[mt]set [_DIQ172_] = NULL
where [_DIQ172_] = 'NA'
update [wwu].[mt]set [_DIQ175A_] = NULL
where [_DIQ175A_] = 'NA'
update [wwu].[mt]set [_DIQ175B_] = NULL
where [_DIQ175B_] = 'NA'

update [wwu].[mt]set [_DIQ175C_] = NULL
where [_DIQ175C_] = 'NA'

update [wwu].[mt]set [_DIQ175D_] = NULL
where [_DIQ175D_] = 'NA'

update [wwu].[mt]set [_DIQ175E_] = NULL
where [_DIQ175E_] = 'NA'

update [wwu].[mt]set [_DIQ175F_] = NULL
where [_DIQ175F_] = 'NA'

update [wwu].[mt]set [_DIQ175G_] = NULL
where [_DIQ175G_] = 'NA'

update [wwu].[mt]set [_DIQ175H_] = NULL
where [_DIQ175H_] = 'NA'

update [wwu].[mt]set [_DIQ175I_] = NULL
where [_DIQ175I_] = 'NA'

update [wwu].[mt]set [_DIQ175J_] = NULL
where [_DIQ175J_] = 'NA'

update [wwu].[mt]set [_DIQ175K_] = NULL
where [_DIQ175K_] = 'NA'

update [wwu].[mt]set [_DIQ175L_] = NULL
where [_DIQ175L_] = 'NA'

update [wwu].[mt]set [_DIQ175M_] = NULL
where [_DIQ175M_] = 'NA'

update [wwu].[mt]set [_DIQ175N_] = NULL
where [_DIQ175N_] = 'NA'

update [wwu].[mt]set [_DIQ175O_] = NULL
where [_DIQ175O_] = 'NA'

update [wwu].[mt]set [_DIQ175P_] = NULL
where [_DIQ175P_] = 'NA'

update [wwu].[mt]set [_DIQ175Q_] = NULL
where [_DIQ175Q_] = 'NA'

update [wwu].[mt]set [_DIQ175R_] = NULL
where [_DIQ175R_] = 'NA'

update [wwu].[mt]set [_DIQ175S_] = NULL
where [_DIQ175S_] = 'NA'

update [wwu].[mt]set [_DIQ175T_] = NULL
where [_DIQ175T_] = 'NA'

update [wwu].[mt]set [_DIQ175U_] = NULL
where [_DIQ175U_] = 'NA'

update [wwu].[mt]set [_DIQ175V_] = NULL
where [_DIQ175V_] = 'NA'

update [wwu].[mt]set [_DIQ175W_] = NULL
where [_DIQ175W_] = 'NA'

update [wwu].[mt]set [_DIQ175X_] = NULL
where [_DIQ175X_] = 'NA'

update [wwu].[mt]set [_DIQ180_] = NULL
where [_DIQ180_] = 'NA'

update [wwu].[mt]set [_DIQ050_] = NULL
where [_DIQ050_] = 'NA'

update [wwu].[mt]set [_DID060_] = NULL
where [_DID060_] = 'NA'

update [wwu].[mt]set [_DIQ060U_] = NULL
where [_DIQ060U_] = 'NA'

update [wwu].[mt]set [_DIQ070_] = NULL
where [_DIQ070_] = 'NA'

update [wwu].[mt]set [_DIQ230_] = NULL
where [_DIQ230_] = 'NA'

update [wwu].[mt]set [_DIQ240_] = NULL
where [_DIQ240_] = 'NA'

update [wwu].[mt]set [_DID250_] = NULL
where [_DID250_] = 'NA'

update [wwu].[mt]set [_DID260_] = NULL
where [_DID260_] = 'NA'

update [wwu].[mt]set [_DIQ260U_] = NULL
where [_DIQ260U_] = 'NA'

update [wwu].[mt]set [_DIQ275_] = NULL
where [_DIQ275_] = 'NA'

update [wwu].[mt]set [_DIQ280_] = NULL
where [_DIQ280_] = 'NA'

update [wwu].[mt]set [_DIQ291_] = NULL
where [_DIQ291_] = 'NA'

update [wwu].[mt]set [_DIQ300S_] = NULL
where [_DIQ300S_] = 'NA'

update [wwu].[mt]set [_DIQ300D_] = NULL
where [_DIQ300D_] = 'NA'

update [wwu].[mt]set [_DID310S_] = NULL
where [_DID310S_] = 'NA'

update [wwu].[mt]set [_DID310D_] = NULL
where [_DID310D_] = 'NA'

update [wwu].[mt]set [_DID320_] = NULL
where [_DID320_] = 'NA'

update [wwu].[mt]set [_DID330_] = NULL
where [_DID330_] = 'NA'

update [wwu].[mt]set [_DID341_] = NULL
where [_DID341_] = 'NA'

update [wwu].[mt]set [_DID350_] = NULL
where [_DID350_] = 'NA'

update [wwu].[mt]set [_DIQ350U_] = NULL
where [_DIQ350U_] = 'NA'

update [wwu].[mt]set [_DIQ360_] = NULL
where [_DIQ360_] = 'NA'

update [wwu].[mt]set [_DIQ080_] = NULL
where [_DIQ080_] = 'NA'

--Verify the variables using count


select COUNT([_DIQ010_]) from [wwu].[mt]
where [_DIQ010_] = '1'

select COUNT([_DIQ010_]) from [wwu].[mt]
where [_DIQ010_] = '2'

select COUNT([_DIQ010_]) from [wwu].[mt]
where [_DIQ010_] = '3'

select COUNT([_DIQ010_]) from [wwu].[mt]
where [_DIQ010_] = '7'

select COUNT([_DIQ010_]) from [wwu].[mt]
where [_DIQ010_] = '9'

select COUNT(*)-COUNT([_DIQ010_]) from [wwu].[mt]




select COUNT([_DID040_]) from [wwu].[mt]
where [_DID040_] between '2' and '78'

select COUNT([_DID040_]) from [wwu].[mt]
where [_DID040_] = '80'

select COUNT([_DID040_]) from [wwu].[mt]
where [_DID040_] = '666'

select COUNT([_DID040_]) from [wwu].[mt]
where [_DID040_] = '777'

select COUNT([_DID040_]) from [wwu].[mt]
where [_DID040_] = '999'

select COUNT(*)-COUNT([_DID040_]) from [wwu].[mt]



select COUNT([_DIQ160_]) from [wwu].[mt]
where [_DIQ160_] = '1'

select COUNT([_DIQ160_]) from [wwu].[mt]
where [_DIQ160_] = '2'

select COUNT([_DIQ160_]) from [wwu].[mt]
where [_DIQ160_] = '7'

select COUNT([_DIQ160_]) from [wwu].[mt]
where [_DIQ160_] = '9'

select COUNT(*)-COUNT([_DIQ160_]) from [wwu].[mt]



select COUNT([_DIQ170_]) from [wwu].[mt]
where [_DIQ170_] = '1'

select COUNT([_DIQ170_]) from [wwu].[mt]
where [_DIQ170_] = '2'

select COUNT([_DIQ170_]) from [wwu].[mt]
where [_DIQ170_] = '7'

select COUNT([_DIQ170_]) from [wwu].[mt]
where [_DIQ170_] = '9'

select COUNT(*)-COUNT([_DIQ170_]) from [wwu].[mt]



select COUNT([_DIQ172_]) from [wwu].[mt]
where [_DIQ172_] = '1'

select COUNT([_DIQ172_]) from [wwu].[mt]
where [_DIQ172_] = '2'

select COUNT([_DIQ172_]) from [wwu].[mt]
where [_DIQ172_] = '7'

select COUNT([_DIQ172_]) from [wwu].[mt]
where [_DIQ172_] = '9'

select COUNT(*)-COUNT([_DIQ172_]) from [wwu].[mt]


select COUNT([_DIQ175A_]) from [wwu].[mt]
where [_DIQ175A_] = '10'

select COUNT([_DIQ175A_]) from [wwu].[mt]
where [_DIQ175A_] = '77'

select COUNT([_DIQ175A_]) from [wwu].[mt]
where [_DIQ175A_] = '99'

select COUNT(*)-COUNT([_DIQ175A_]) from [wwu].[mt]


select COUNT([_DIQ175B_]) from [wwu].[mt]
where [_DIQ175B_] = '11'
select COUNT(*)-COUNT([_DIQ175B_]) from [wwu].[mt]

select COUNT([_DIQ175C_]) from [wwu].[mt]
where [_DIQ175C_] = '12'
select COUNT(*)-COUNT([_DIQ175C_]) from [wwu].[mt]

select COUNT([_DIQ175D_]) from [wwu].[mt]
where [_DIQ175D_] = '13'
select COUNT(*)-COUNT([_DIQ175D_]) from [wwu].[mt]

select COUNT([_DIQ175E_]) from [wwu].[mt]
where [_DIQ175E_] = '14'
select COUNT(*)-COUNT([_DIQ175E_]) from [wwu].[mt]

select COUNT([_DIQ175F_]) from [wwu].[mt]
where [_DIQ175F_] = '15'
select COUNT(*)-COUNT([_DIQ175F_]) from [wwu].[mt]

select COUNT([_DIQ175G_]) from [wwu].[mt]
where [_DIQ175G_] = '16'
select COUNT(*)-COUNT([_DIQ175G_]) from [wwu].[mt]

select COUNT([_DIQ175H_]) from [wwu].[mt]
where [_DIQ175H_] = '17'
select COUNT(*)-COUNT([_DIQ175H_]) from [wwu].[mt]

select COUNT([_DIQ175I_]) from [wwu].[mt]
where [_DIQ175I_] = '18'
select COUNT(*)-COUNT([_DIQ175I_]) from [wwu].[mt]

select COUNT([_DIQ175J_]) from [wwu].[mt]
where [_DIQ175J_] = '19'
select COUNT(*)-COUNT([_DIQ175J_]) from [wwu].[mt]

select COUNT([_DIQ175K_]) from [wwu].[mt]
where [_DIQ175K_] = '20'
select COUNT(*)-COUNT([_DIQ175K_]) from [wwu].[mt]

select COUNT([_DIQ175L_]) from [wwu].[mt]
where [_DIQ175L_] = '21'
select COUNT(*)-COUNT([_DIQ175L_]) from [wwu].[mt]

select COUNT([_DIQ175M_]) from [wwu].[mt]
where [_DIQ175M_] = '22'
select COUNT(*)-COUNT([_DIQ175M_]) from [wwu].[mt]

select COUNT([_DIQ175N_]) from [wwu].[mt]
where [_DIQ175N_] = '23'
select COUNT(*)-COUNT([_DIQ175N_]) from [wwu].[mt]

select COUNT([_DIQ175O_]) from [wwu].[mt]
where [_DIQ175O_] = '24'
select COUNT(*)-COUNT([_DIQ175O_]) from [wwu].[mt]

select COUNT([_DIQ175P_]) from [wwu].[mt]
where [_DIQ175P_] = '25'
select COUNT(*)-COUNT([_DIQ175P_]) from [wwu].[mt]

select COUNT([_DIQ175Q_]) from [wwu].[mt]
where [_DIQ175Q_] = '26'
select COUNT(*)-COUNT([_DIQ175Q_]) from [wwu].[mt]

select COUNT([_DIQ175R_]) from [wwu].[mt]
where [_DIQ175R_] = '27'
select COUNT(*)-COUNT([_DIQ175R_]) from [wwu].[mt]

select COUNT([_DIQ175S_]) from [wwu].[mt]
where [_DIQ175S_] = '28'
select COUNT(*)-COUNT([_DIQ175S_]) from [wwu].[mt]

select COUNT([_DIQ175T_]) from [wwu].[mt]
where [_DIQ175T_] = '29'
select COUNT(*)-COUNT([_DIQ175T_]) from [wwu].[mt]

select COUNT([_DIQ175U_]) from [wwu].[mt]
where [_DIQ175U_] = '30'
select COUNT(*)-COUNT([_DIQ175U_]) from [wwu].[mt]

select COUNT([_DIQ175V_]) from [wwu].[mt]
where [_DIQ175V_] = '31'
select COUNT(*)-COUNT([_DIQ175V_]) from [wwu].[mt]

select COUNT([_DIQ175W_]) from [wwu].[mt]
where [_DIQ175W_] = '32'
select COUNT(*)-COUNT([_DIQ175W_]) from [wwu].[mt]

select COUNT([_DIQ175X_]) from [wwu].[mt]
where [_DIQ175X_] = '33'
select COUNT(*)-COUNT([_DIQ175X_]) from [wwu].[mt]


select COUNT([_DIQ180_]) from [wwu].[mt]
where [_DIQ180_] = '1'

select COUNT([_DIQ180_]) from [wwu].[mt]
where [_DIQ180_] = '2'

select COUNT([_DIQ180_]) from [wwu].[mt]
where [_DIQ180_] = '7'

select COUNT([_DIQ180_]) from [wwu].[mt]
where [_DIQ180_] = '9'

select COUNT(*)-COUNT([_DIQ180_]) from [wwu].[mt]

select COUNT([_DIQ050_]) from [wwu].[mt]
where [_DIQ050_] = '1'

select COUNT([_DIQ050_]) from [wwu].[mt]
where [_DIQ050_] = '2'

select COUNT([_DIQ050_]) from [wwu].[mt]
where [_DIQ050_] = '7'

select COUNT([_DIQ050_]) from [wwu].[mt]
where [_DIQ050_] = '9'

select COUNT(*)-COUNT([_DIQ050_]) from [wwu].[mt]


select COUNT([_DID060_]) from [wwu].[mt]
where [_DID060_] between '1' and '55'

select COUNT([_DID060_]) from [wwu].[mt]
where [_DID060_] = '666'

select COUNT([_DID060_]) from [wwu].[mt]
where [_DID060_] = '777'

select COUNT([_DID060_]) from [wwu].[mt]
where [_DID060_] = '999'

select COUNT(*)-COUNT([_DID060_]) from [wwu].[mt]

select COUNT([_DIQ060U_]) from [wwu].[mt]
where [_DIQ060U_] = '1'

select COUNT([_DIQ060U_]) from [wwu].[mt]
where [_DIQ060U_] = '2'

select COUNT(*)-COUNT([_DIQ060U_]) from [wwu].[mt]


select COUNT([_DIQ070_]) from [wwu].[mt]
where [_DIQ070_] = '1'

select COUNT([_DIQ070_]) from [wwu].[mt]
where [_DIQ070_] = '2'

select COUNT([_DIQ070_]) from [wwu].[mt]
where [_DIQ070_] = '7'

select COUNT([_DIQ070_]) from [wwu].[mt]
where [_DIQ070_] = '9'

select COUNT(*)-COUNT([_DIQ070_]) from [wwu].[mt]

select COUNT([_DIQ230_]) from [wwu].[mt]
where [_DIQ230_] = '1'

select COUNT([_DIQ230_]) from [wwu].[mt]
where [_DIQ230_] = '2'

select COUNT([_DIQ230_]) from [wwu].[mt]
where [_DIQ230_] = '3'

select COUNT([_DIQ230_]) from [wwu].[mt]
where [_DIQ230_] = '4'

select COUNT([_DIQ230_]) from [wwu].[mt]
where [_DIQ230_] = '5'

select COUNT([_DIQ230_]) from [wwu].[mt]
where [_DIQ230_] = '7'

select COUNT([_DIQ230_]) from [wwu].[mt]
where [_DIQ230_] = '9'

select COUNT(*)-COUNT([_DIQ230_]) from [wwu].[mt]


alter table [wwu].[mt] alter column [_DID040_] float;
--I alter 666 to 1 on the grounds that it means the age is less than 1 year.
update [wwu].[mt] set [_DID040_] = 0.5
where [_DID040_] = 666
--And I use the mean value to esitimate the "DON'T KNOW" value
select AVG([_DID040_]) from [wwu].[mt]
where [_DID040_] != 999
update [wwu].[mt]set [_DID040_] = 48.4
where [_DID040_] = '999' 

--for diq050, I check the data first and then treat "DON'T KNOW" and "REFUSE" as missing values.
select COUNT([_DIQ050_]) from [wwu].[mt]
where [_DIQ050_] = 1 
select COUNT([_DIQ050_]) from [wwu].[mt]
where [_DIQ050_] = 2
select COUNT([_DIQ050_]) from [wwu].[mt]
where [_DIQ050_] = 7 
select COUNT([_DIQ050_]) from [wwu].[mt]
where [_DIQ050_] = 9 
select COUNT(*)-count([_DIQ050_]) from [wwu].[mt]

update [wwu].[mt] set [_DIQ050_] = NULL
where [_DIQ050_] = '7';
update [wwu].[mt] set [_DIQ050_] = NULL
where [_DIQ050_] = '9';

--For did060
alter table [wwu].[mt] alter column [_DID060_] float
update [wwu].[mt] set [_DID060_] = 0.5
where [_DID060_] = 666;
update [wwu].[mt] set [_DIQ060U_] = 12
where [_DIQ060U_] = 2;
update [wwu].[mt] set [_DID060_] = [_DID060_]*[_DIQ060U_]
where [_DID060_] != 999;
select AVG ([_DID060_]) from [wwu].[mt]
where  [_DID060_] ! = 9999
update [wwu].[mt] set [_DID060_] = 109.42
where [_DID060_] = 999;

--For diq230, I still check the data with the website first and then change '5' to '0' and change '9' to 'NULL'
select COUNT([_DIQ230_]) from [wwu].[mt]
where [_DIQ230_] = 1 
select COUNT([_DIQ230_]) from [wwu].[mt]
where [_DIQ230_] = 2
select COUNT([_DIQ230_]) from [wwu].[mt]
where [_DIQ230_] = 3 
select COUNT([_DIQ230_]) from [wwu].[mt]
where [_DIQ230_] = 4 
select COUNT([_DIQ230_]) from [wwu].[mt]
where [_DIQ230_] = 5 
select COUNT([_DIQ230_]) from [wwu].[mt]
where [_DIQ230_] = 7 
select COUNT([_DIQ230_]) from [wwu].[mt]
where [_DIQ230_] = 9 
select COUNT(*) - COUNT([_DIQ230_]) from [wwu].[mt]
update [wwu].[mt] set [_DIQ230_] = NULL
where [_DIQ050_] = 9;
update [wwu].[mt] set [_DIQ230_] = 0
where [_DIQ050_] = 5;
--For 240, I just check the data.
select COUNT([_DIQ240_]) from [wwu].[mt]
where [_DIQ240_] = 1 
select COUNT([_DIQ240_]) from [wwu].[mt]
where [_DIQ240_] = 2
select COUNT([_DIQ240_]) from [wwu].[mt]
where [_DIQ240_] = 7 
select COUNT([_DIQ240_]) from [wwu].[mt]
where [_DIQ240_] = 9 
select COUNT(*) - COUNT([_DIQ240_]) from [wwu].[mt]
--For did250
update [wwu].[mt] set [_DID250_] = 4.508
where [_DID250_] = 9999
--for diq260, I unify unit to per day first, then calculate the mean value and use it to estimate "DON'T KNOW" value.
alter table [wwu].[mt] alter column [_DID260_] float;
alter table [wwu].[mt] alter column [_DIQ260U_] float;
update [wwu].[mt] set [_DIQ260U_] = 0
where [_DIQ260U_] is NULL;
update [wwu].[mt] set [_DIQ260U_] = 1/7
where [_DIQ260U_] = 2;
update [wwu].[mt] set [_DIQ260U_] = 1/30
where [_DIQ260U_] = 3;
update [wwu].[mt] set [_DIQ260U_] = 1/365
where [_DIQ260U_] = 4;
update [wwu].[mt] set [_DID260_] = [_DID260_] * [_DIQ260U_]
where [_DID260_] ! = 999;
select AVG ([_DID260_]) from [wwu].[mt]
where  [_DID260_] ! = 999;
update [wwu].[mt] set [_DID260_] = 0.925
where [_DID260_] = 999;
--For diq275, still check the data first, and then 
select COUNT([_DIQ275_]) from [wwu].[mt]
where [_DIQ275_] = 1 
select COUNT([_DIQ275_]) from [wwu].[mt]
where [_DIQ275_] = 2
select COUNT([_DIQ275_]) from [wwu].[mt]
where [_DIQ275_] = 7 
select COUNT([_DIQ275_]) from [wwu].[mt]
where [_DIQ275_] = 9 
select COUNT(*) - COUNT([_DIQ275_]) from [wwu].[mt]

--diq280, I still do the same thing.
alter table [wwu].[mt]alter column [_DIQ280_] float;
alter table [wwu].[mt] alter column [_DIQ280_] float;
update [wwu].[mt]set [_DIQ280_] = NULL
where [_DIQ280_] = 777;
select AVG([_DIQ280_]) from [wwu].[mt]
where _DIQ280_ != 999; 
update [wwu].[mt] set [_DIQ280_] = 7.334
where [_DIQ280_] = 999
--diq291
select COUNT([_DIQ291_]) from [wwu].[mt]
where [_DIQ291_] = 1 
select COUNT([_DIQ291_]) from [wwu].[mt]
where [_DIQ291_] = 2
select COUNT([_DIQ291_]) from [wwu].[mt]
where [_DIQ291_] = 3 
select COUNT([_DIQ291_]) from [wwu].[mt]
where [_DIQ291_] = 4
select COUNT([_DIQ291_]) from [wwu].[mt]
where [_DIQ291_] = 5
select COUNT([_DIQ291_]) from [wwu].[mt]
where [_DIQ291_] = 6
select COUNT([_DIQ291_]) from [wwu].[mt]
where [_DIQ291_] = 77
select COUNT([_DIQ291_]) from [wwu].[mt]
where [_DIQ291_] = 99
select COUNT(*) - COUNT([_DIQ291_]) from [wwu].[mt]
--diq300s
alter table [wwu].[mt] alter column [_DIQ300S_] float
update [wwu].[mt]set [_DIQ300S_] = NULL
where [_DIQ300S_] = 7777;
select AVG([_DIQ300S_]) from [wwu].[mt]
where _DIQ300S_ != 9999; 
update [wwu].[mt]set [_DIQ300S_] = 130.4935
where _DIQ300S_ = 9999;
--300d
alter table [wwu].[mt] alter column [_DIQ300D_] float;
update [wwu].[mt]set [_DIQ300D_] = NULL
where [_DIQ300D_] = 7777;
select AVG([_DIQ300D_]) from [wwu].[mt]
where _DIQ300D_ != 9999; 
update [wwu].[mt]set [_DIQ300D_] = 78.2291
where _DIQ300D_ = 9999;
--310s
alter table [wwu].[mt] alter column [_DID310S_] float;
update [wwu].[mt]set [_DId310S_] = NULL
where [_DId310S_] = 7777;
update [wwu].[mt]set [_DId310S_] = NULL
where [_DId310S_] = 6666;
select AVG([_DId310S_]) from [wwu].[mt]
where _DId310S_ != 9999; 
update [wwu].[mt]set [_DId310S_] = 123.0595
where _DId310S_ = 9999;
--310d
alter table [wwu].[mt] alter column [_DID310S_] float;
update [wwu].[mt]set [_DId310S_] = NULL
where [_DId310S_] = 7777;
update [wwu].[mt]set [_DId310S_] = NULL
where [_DId310S_] = 6666;
select AVG([_DId310S_]) from [wwu].[mt]
where _DId310S_ != 9999; 
update [wwu].[mt]set [_DId310S_] = 123.0595
where _DId310S_ = 9999;
--did320
alter table [wwu].[mt] alter column [_DID320_] float;
update [wwu].[mt]set [_DID320_] = NULL
where [_DID320_] = 7777;
update [wwu].[mt]set [_DID320_] = NULL
where [_DID320_] = 6666;
update [wwu].[mt]set [_DID320_] = NULL
where [_DID320_] = 5555;
select AVG([_DId320_]) from [wwu].[mt]
where _DId320_ != 9999; 
update [wwu].[mt]set [_DId320_] = 122.9826
where _DId320_ = 9999;
--DID330
alter table [wwu].[mt] alter column [_DID330_] float;
update [wwu].[mt]set [_DID330_] = NULL
where [_DID330_] = 7777;
update [wwu].[mt]set [_DID330_] = NULL
where [_DID330_] = 6666;
select AVG([_DId330_]) from [wwu].[mt]
where _DId330_ != 9999; 
update [wwu].[mt]set [_DId330_] = 116.2
where _DId330_ = 9999;
--DID341
alter table [wwu].[mt] alter column [_DID341_] float;
update [wwu].[mt]set [_DID341_] = NULL
where [_DID341_] = 7777;
update [wwu].[mt]set [_DID341_] = NULL
where [_DID341_] = 6666;
select AVG([_DId341_]) from [wwu].[mt]
where _DId341_ != 9999; 
update [wwu].[mt]set [_DID341_] = 2.4
where _DId341_ = 9999;
--diq350
alter table [wwu].[mt] alter column [_DID350_] float;
alter table [wwu].[mt] alter column [_DIQ350U_] float;
update [wwu].[mt] set [_DIQ350U_] = 0
where [_DIQ350U_] is NULL;
update [wwu].[mt] set [_DIQ350U_] = 1/7
where [_DIQ350U_] = 2;
update [wwu].[mt] set [_DIQ350U_] = 1/30
where [_DIQ350U_] = 3;
update [wwu].[mt] set [_DIQ350U_] = 1/365
where [_DIQ350U_] = 4;
update [wwu].[mt] set [_DID350_] = [_DID350_] * [_DIQ350U_]
where [_DID350_] ! = 9999;
select AVG ([_DID350_]) from [wwu].[mt]
where  [_DID350_] ! = 9999;
update [wwu].[mt] set [_DID350_] = 1.2208
where [_DID350_] = 9999;
--diq360
select COUNT([_DIQ360_]) from [wwu].[mt]
where [_DIQ360_]= 1 
select COUNT([_DIQ360_]) from [wwu].[mt]
where [_DIQ360_]= 2
select COUNT([_DIQ360_]) from [wwu].[mt]
where [_DIQ360_]= 3 
select COUNT([_DIQ360_]) from [wwu].[mt]
where [_DIQ360_]= 4
select COUNT([_DIQ360_]) from [wwu].[mt]
where [_DIQ360_]= 5
select COUNT([_DIQ360_]) from [wwu].[mt]
where [_DIQ360_]= 7
select COUNT([_DIQ360_]) from [wwu].[mt]
where [_DIQ360_]= 9
select COUNT(*) - COUNT([_DIQ360_]) from [wwu].[mt]
--diq080
select COUNT([_DIQ080_]) from [wwu].[mt]
where [_DIQ080_] = 1 
select COUNT([_DIQ080_]) from [wwu].[mt]
where [_DIQ080_] = 2
select COUNT([_DIQ080_]) from [wwu].[mt]
where [_DIQ080_] = 7 
select COUNT([_DIQ080_]) from [wwu].[mt]
where [_DIQ080_] = 9 
select COUNT(*) - COUNT([_DIQ080_]) from [wwu].[mt]

select * into wwu.test from [wwu].[DIQ]


EXEC sp_rename 'wwu.DIQ._seqn_','respondent sequence number';
EXEC sp_rename 'wwu.DIQ._diq010_','doctor told you have diabetes';
EXEC sp_rename 'wwu.DIQ._did040_','age when first told you had diabetes';
EXEC sp_rename 'wwu.DIQ._diq160_','ever told you have prediabetes';
EXEC sp_rename 'wwu.DIQ._diq170_','ever told have health risk for diabetes';
EXEC sp_rename 'wwu.DIQ._diq172_','feel could be at risk for diabetes';
EXEC sp_rename 'wwu.DIQ._diq175a_','family history';
EXEC sp_rename 'wwu.DIQ._diq175b_','overweight';
EXEC sp_rename 'wwu.DIQ._diq175c_','Age';
EXEC sp_rename 'wwu.DIQ._diq175d_','poor diet';
EXEC sp_rename 'wwu.DIQ._diq175e_','race';
EXEC sp_rename 'wwu.DIQ._diq175f_','had a baby weighed over 9 lbs. at birth';
EXEC sp_rename 'wwu.DIQ._diq175g_','lack of physical activity';
EXEC sp_rename 'wwu.DIQ._diq175h_','high boold pressure';
EXEC sp_rename 'wwu.DIQ._diq175i_','high boold sugar';
EXEC sp_rename 'wwu.DIQ._diq175j_','high cholesterol';
EXEC sp_rename 'wwu.DIQ._diq175k_','hypoglycemic';
EXEC sp_rename 'wwu.DIQ._diq175l_','extreme hunger';
EXEC sp_rename 'wwu.DIQ._diq175m_','tingling';
EXEC sp_rename 'wwu.DIQ._diq175n_','blurred vision';
EXEC sp_rename 'wwu.DIQ._diq175o_','increased fatigue';
EXEC sp_rename 'wwu.DIQ._diq175p_','anyone could be at risk';
EXEC sp_rename 'wwu.DIQ._diq175q_','doctor warming';
EXEC sp_rename 'wwu.DIQ._diq175r_','other, specify';
EXEC sp_rename 'wwu.DIQ._diq175s_','gestational diabetes';
EXEC sp_rename 'wwu.DIQ._diq175t_','frequent urination ';
EXEC sp_rename 'wwu.DIQ._diq175u_','thirst';
EXEC sp_rename 'wwu.DIQ._diq175v_','craving for sweet/eating a ';
EXEC sp_rename 'wwu.DIQ._diq175w_','medication';
EXEC sp_rename 'wwu.DIQ._diq175x_','polycystic ovarian syndrome';
EXEC sp_rename 'wwu.DIQ._diq180_','had blood tested past three years';
EXEC sp_rename 'wwu.DIQ._diq050_','taking insulin now';
EXEC sp_rename 'wwu.DIQ._did060_','how long taking insulin';
EXEC sp_rename 'wwu.DIQ._diq060u_','unit of measure';
EXEC sp_rename 'wwu.DIQ._diq070_','take diabetic pills to lower blood sugar';
EXEC sp_rename 'wwu.DIQ._diq230_','how long ago saw a diabetes specialist';
EXEC sp_rename 'wwu.DIQ._diq240_','is there one dr you see for diabetes';
EXEC sp_rename 'wwu.DIQ._did250_','past year how many times seen doctor';
EXEC sp_rename 'wwu.DIQ._did260_','how often check blood for sugar';
EXEC sp_rename 'wwu.DIQ._diq260u_','unit of measure';
EXEC sp_rename 'wwu.DIQ._diq275_','past year dr checked for A1C';
EXEC sp_rename 'wwu.DIQ._diq280_','what was your last A1C level';
EXEC sp_rename 'wwu.DIQ._diq291_','what does dr say A1C should be';
EXEC sp_rename 'wwu.DIQ._diq300s_','what was your recent SBP';
EXEC sp_rename 'wwu.DIQ._diq300d_','what was your recent DBP';
EXEC sp_rename 'wwu.DIQ._diq310s_','what does Dr say SBP should be';
EXEC sp_rename 'wwu.DIQ._did310d_','what does Dr say DBP should be';
EXEC sp_rename 'wwu.DIQ._did320_','what was most recent LDL number';
EXEC sp_rename 'wwu.DIQ._did330_','what does Dr say LDL should be';
EXEC sp_rename 'wwu.DIQ._did341_','past year times Dr check feet for sores';
EXEC sp_rename 'wwu.DIQ._did350_','How often do you check your feet';
EXEC sp_rename 'wwu.DIQ._diq350u_','unit of measure ';
EXEC sp_rename 'wwu.DIQ._diq360_','last time had pupils dilated for exam';
EXEC sp_rename 'wwu.DIQ._diq080_','diabetes affected eyes';
